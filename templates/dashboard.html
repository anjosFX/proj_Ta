<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - FeKnight Store</title>
      <link rel="stylesheet" href="{{ url_for('static', filename='dashboard.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- HEADER COM NAVEGAÇÃO -->
    <header class="dashboard-header">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-chart-line logo-icon"></i>
                <h1>FeKnight Analytics</h1>
            </div>
            
            <nav class="nav-links">
                <a href="/"><i class="fas fa-store"></i> Loja</a>
                <a href="/carrinho"><i class="fas fa-shopping-cart"></i> Carrinho</a>
                <a href="/perfil"><i class="fas fa-user"></i> Perfil</a>
                <a href="/dashboard" class="active"><i class="fas fa-chart-bar"></i> Dashboard</a>
            </nav>
            
            <a href="/" class="back-btn">
                <i class="fas fa-arrow-left"></i> Voltar à Loja
            </a>
        </div>
    </header>

    <!-- CONTEÚDO PRINCIPAL -->
    <div class="container">
        <!-- TÍTULO DA PÁGINA -->
        <div class="page-title">
            <h1><i class="fas fa-chart-pie"></i> Painel de Controle</h1>
            <p>Análise em tempo real das métricas da FeKnight Store. Dados processados com Python e visualizados com Matplotlib.</p>
        </div>

        <!-- CARDS DE ESTATÍSTICAS -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-shopping-bag"></i>
                </div>
                <h3>Total de Vendas</h3>
                <div class="stat-number">{{ total_vendas }}</div>
                <p>Unidades vendidas na loja</p>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-tshirt"></i>
                </div>
                <h3>Produtos Cadastrados</h3>
                <div class="stat-number">{{ total_produtos }}</div>
                <p>Modelos disponíveis</p>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-users"></i>
                </div>
                <h3>Clientes Registrados</h3>
                <div class="stat-number">{{ total_usuarios }}</div>
                <p>Usuários cadastrados</p>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <h3>Média de Preços</h3>
                <div class="stat-number">R$ {{ "%.2f"|format(preco_medio|default(0)) }}</div>
                <p>Preço médio dos produtos</p>
            </div>
        </div>

        <!-- GRÁFICOS -->
        <div class="charts-container">
            <h2><i class="fas fa-chart-bar"></i> Visualizações de Dados</h2>
            
            <div class="chart-wrapper">
                <h3>Análise de Vendas e Produtos</h3>
                {% if plot_url %}
                    <img src="data:image/png;base64,{{ plot_url }}" alt="Gráficos de Análise" class="chart-img">
                {% else %}
                    <div class="no-data">
                        <i class="fas fa-chart-bar"></i>
                        <h3>Sem dados para exibir</h3>
                        <p>Realize vendas para gerar análises visuais</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer class="dashboard-footer">
        <p>FeKnight Store Dashboard &copy; 2023 | Desenvolvido com Flask, Python e Matplotlib</p>
        <p><i class="fas fa-code"></i> Projeto Técnico em Informática</p>
    </footer>

    <!-- SCRIPT PARA ATUALIZAÇÃO AUTOMÁTICA (OPCIONAL) -->
    <script>
        // Atualizar a página a cada 60 segundos para dados em tempo real
        setTimeout(function() {
            window.location.reload();
        }, 60000);
        
        // Efeito de hover nos cards
        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('.stat-card');
            
            cards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-10px)';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                });
            });
            
            // Adicionar data atual ao footer
            const date = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            const dateString = date.toLocaleDateString('pt-BR', options);
            
            const footer = document.querySelector('.dashboard-footer');
            const dateElement = document.createElement('p');
            dateElement.innerHTML = `<i class="fas fa-calendar-alt"></i> Última atualização: ${dateString}`;
            dateElement.style.marginTop = '10px';
            dateElement.style.fontSize = '0.8rem';
            dateElement.style.color = '#666';
            footer.appendChild(dateElement);
        });
    </script>
</body>
</html>